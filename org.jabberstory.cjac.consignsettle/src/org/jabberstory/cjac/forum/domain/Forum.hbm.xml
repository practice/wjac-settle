<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE hibernate-mapping PUBLIC
	"-//Hibernate/Hibernate Mapping DTD 3.0//EN"
	"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd" >
	
<hibernate-mapping package="org.jabberstory.cjac.forum.domain" default-access="field">

	<class name="Forum" table="FORUM">
		<id name="id" column="FORUMID">
			<generator class="native" />
		</id>
		<property name="name" column="NAME" type="string" length="64" />
		<property name="groupId" column="GROUPID" type="string" length="32" />
		<property name="forumType" column="FORUMTYPE" type="string" length="10" />
		<property name="enabled" column="ENABLED" type="yes_no"></property>
	</class>
	
	<class name="ForumPost" table="FORUMPOST">
		<id name="id" column="POSTID">
			<generator class="native" />
		</id>
		<property name="step" column="STEP" type="int" />
		<property name="depth" column="DEPTH" type="int" />
		<property name="rootId" column="ROOTPOSTID" type="int" />
		<property name="subject" column="SUBJECT" type="string" length="128" />
		<property name="body" column="BODY" type="text" />
		<!-- property name="createdDate" column="WTIME" type="timestamp" insert="false" update="false" generated="always" / -->
		<property name="createdDate" column="WTIME" type="timestamp" />
		<property name="readCount" column="READCOUNT" type="int" length="8" />
		<property name="replyCount" column="REPLYCOUNT" type="int" length="4" />
		<property name="hidden" column="HIDDEN" type="yes_no" />
		<many-to-one name="user" column="USERID" class="org.jabberstory.cjac.consignsettle.domain.User" 
			foreign-key="FK_USER_POST" fetch="join" />
		<list name="attachments" cascade="save-update, delete">
			<key column="POSTID" />
			<list-index column="LISTINDEX" />
			<one-to-many class="PostAttachment" />
		</list>
		<many-to-one name="forum" column="FORUMID" class="Forum" 
			foreign-key="FK_FORUM_POST"/>
	</class>
	
	<class name="PostAttachment" table="POSTATTACHMENT">
		<id name="id" column="ATTID">
			<generator class="native" />
		</id>
		<property name="filename" column="FILENAME" length="256" />
		<property name="filesize" column="FILESIZE" length="16" />
		<property name="dir" column="DIR" length="256" />
		<many-to-one name="post" column="POSTID" class="ForumPost" foreign-key="FK_POST_ATTACHMENT" />
	</class>

</hibernate-mapping>
