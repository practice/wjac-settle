<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:p="http://www.springframework.org/schema/p" 
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
			http://www.springframework.org/schema/beans/spring-beans-2.5.xsd">
	
	<!-- ############################################################## -->
	<!-- Request Mapping -->
	<!-- ############################################################## -->
	<bean id="commonVariableInterceptor" class="org.jabberstory.cjac.consignsettle.common.util.CommonVariableInterceptorAdaptor" 
		p:userService-ref="userService" />
	
	<bean id="handlerMapping"
		class="org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping">
	</bean>
	<bean id="simpleMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
		<property name="interceptors">
			<list>
				<ref bean="commonVariableInterceptor" />
			</list>
		</property>
		<property name="alwaysUseFullPath" value="true"></property>
		<property name="mappings">
			<props>
				<prop key="/user/list">userListController</prop>
				<prop key="/user/createUserGroup">createUserGroupController</prop>
				<prop key="/user/updateUserGroup">updateUserGroupController</prop>
				<prop key="/user/showUserGroup">showUserGroupController</prop>
				<prop key="/user/removeUserGroup">removeUserGroupController</prop>
				<prop key="/user/createUser">createUserController</prop>
				<prop key="/user/showUser">showUserController</prop>
				<prop key="/organ/excelDownload">organExcelController</prop>
				<prop key="/organ/zipCodeList">zipCodeListController</prop>
				<prop key="/organ/*">organMultiActionController</prop>
				<prop key="/login">loginController</prop>
				<prop key="/forum/*/list">forumListController</prop>
				<prop key="/forum/*/write">writeController</prop>
				<prop key="/forum/*/updatePost">updatePostController</prop>
				<prop key="/forum/*/removePost">removePostController</prop>
				<prop key="/forum/*/showpost">showPostController</prop>
				<prop key="/forum/*/download">downloadController</prop>
				<prop key="/admin/*">authAdminMultiActionController</prop>
			</props>
		</property>
	</bean>

	<!-- ############################################################## -->
	<!--  User Management Controller -->
	<!-- ############################################################## -->
	<bean id="showUserController" class="org.jabberstory.cjac.consignsettle.controller.ShowUserController" 
		p:userService-ref="userService" />
	<bean id="createUserController" class="org.jabberstory.cjac.consignsettle.controller.CreateUserController"
		p:successView=""
		p:formView="user/createUser"
		p:validator-ref="createUserValidator"
		p:userService-ref="userService" />
	<bean id="createUserValidator" class="org.jabberstory.cjac.consignsettle.controller.CreateUserValidator" />
	<bean id="removeUserGroupController" class="org.jabberstory.cjac.consignsettle.controller.RemoveUserGroupController"
		p:userService-ref="userService" />
	<bean id="showUserGroupController" class="org.jabberstory.cjac.consignsettle.controller.ShowUserGroupController"
		p:userService-ref="userService" />
	<bean id="userListController" class="org.jabberstory.cjac.consignsettle.controller.UserListController" 
		p:successView="user/userList"
		p:formView="user/userList"
		p:userService-ref="userService" />
	<bean id="updateUserGroupController" class="org.jabberstory.cjac.consignsettle.controller.UpdateUserGroupController"
		p:successView=""
		p:formView="user/updateUserGroup"
		p:userService-ref="userService" />
	<bean id="createUserGroupController" class="org.jabberstory.cjac.consignsettle.controller.CreateUserGroupController"
		p:successView=""
		p:formView="cuser/reateUserGroup"
		p:validator-ref="createUserGroupValidator"
		p:userService-ref="userService" />
	<bean id="createUserGroupValidator" class="org.jabberstory.cjac.consignsettle.controller.CreateUserGroupValidator" />
	
	<!-- ############################################################## -->
	<!--  Authorization Administration Controller -->
	<!-- ############################################################## -->
	<bean id="authAdminMultiActionController" class="org.jabberstory.cjac.consignsettle.controller.AuthAdminMultiActionController">
		<property name="organService" ref="organService" />
		<property name="userService" ref="userService" />
		<property name="methodNameResolver"	ref="authAdminMultiActionControllerMethodNameResolver" />
	</bean>
	
	<bean id="authAdminMultiActionControllerMethodNameResolver" class="org.springframework.web.servlet.mvc.multiaction.PropertiesMethodNameResolver">
		<property name="mappings">
			<props>
				<prop key="/showUserAuthAdmin">showUserAuthAdmin</prop>
				<prop key="/updateUserAuthAdmin">updateUserAuthAdmin</prop>
				<prop key="/*">others</prop>
			</props>
		</property>		
	</bean>
	
	<!-- ############################################################## -->
	<!--  Organization(Owner, Subject) Management Controller -->
	<!-- ############################################################## -->
	<bean id="organExcelView" class="org.jabberstory.cjac.consignsettle.view.OrganExcelView" />
	
	<bean id="organExcelController" class="org.jabberstory.cjac.consignsettle.controller.OrganExcelController" 
		p:organExcelView-ref="organExcelView"
		p:organService-ref="organService"
		p:userService-ref="userService" />			
		
	<bean id="zipCodeListController" class="org.jabberstory.cjac.consignsettle.controller.ZipCodeListController" 
		p:successView="organ/zipCodeList"
		p:formView="organ/zipCodeList"
		p:zipCodeService-ref="zipCodeService" />
		
	<bean id="organMultiActionController" class="org.jabberstory.cjac.consignsettle.controller.OrganMultiActionController">
		<property name="organService" ref="organService" />
		<property name="userService" ref="userService" />
		<property name="methodNameResolver"	ref="organMultiActionControllerMethodNameResolver" />
	</bean>
	
	<bean id="organMultiActionControllerMethodNameResolver" class="org.springframework.web.servlet.mvc.multiaction.PropertiesMethodNameResolver">
		<property name="mappings">
			<props>
				<prop key="/subjectList">subjectPagingList</prop>
				<prop key="/createSubject">createSubject</prop>
				<prop key="/showSubject">showSubject</prop>
				<prop key="/updateSubject">updateSubject</prop>
				<prop key="/deleteSubject">deleteSubject</prop>
				<prop key="/showCostDetail">showCostDetail</prop>
				<prop key="/updateCostDetail">updateCostDetail</prop>
				<prop key="/deleteCostDetail">deleteCostDetail</prop>
				<prop key="/showNonApproval1">showNonApproval1</prop>
				<prop key="/updateNonApproval1">updateNonApproval1</prop>
				<prop key="/deleteNonApproval1">deleteNonApproval1</prop>
				<prop key="/showNonApproval2">showNonApproval2</prop>
				<prop key="/updateNonApproval2">updateNonApproval2</prop>
				<prop key="/deleteNonApproval2">deleteNonApproval2</prop>
				<prop key="/settlementList">settlementPagingList</prop>
				<prop key="/*">others</prop>
			</props>
		</property>		
	</bean>

	<!-- ############################################################## -->
	<!-- Forum Controller -->
	<!-- ############################################################## -->
	<bean id="removePostController" class="org.jabberstory.cjac.forum.controller.RemovePostController"
		p:forumService-ref="forumService" />
	<bean id="updatePostController" class="org.jabberstory.cjac.forum.controller.UpdatePostController"
		p:successView=""
		p:formView="forum/updatePost"
		p:forumService-ref="forumService" />
	<bean id="writeController" class="org.jabberstory.cjac.forum.controller.WriteController" 
		p:successView=""
		p:formView="forum/write"
		p:forumService-ref="forumService" 
		p:validator-ref="writeValidator" />
	<bean id="writeValidator" class="org.jabberstory.cjac.forum.controller.WriteCommandValidator" />
	<bean id="forumListController" class="org.jabberstory.cjac.forum.controller.ForumListController" 
		p:forumService-ref="forumService" />
	<bean id="showPostController" class="org.jabberstory.cjac.forum.controller.ShowPostController" 
		p:forumService-ref="forumService" />
	<bean id="downloadController" class="org.jabberstory.cjac.forum.controller.AttachmentDownloadController" 
		p:forumService-ref="forumService" />
	
	<bean id="downloadView" class="org.jabberstory.cjac.forum.view.DownloadView" />

	<!-- ############################################################## -->
	<!--  General purpose beans -->
	<!-- ############################################################## -->
	<bean id="loginController" class="org.jabberstory.cjac.consignsettle.controller.LoginController" 
		p:userService-ref="userService" />
	<bean id="urlController" class="org.springframework.web.servlet.mvc.UrlFilenameViewController" />

	<bean id="viewResolver" class="org.springframework.web.servlet.view.UrlBasedViewResolver"
		p:order="0">
		<property name="viewClass" value="org.springframework.web.servlet.view.tiles2.TilesView" />
	</bean>
	<bean id="beanNameViewResolver" class="org.springframework.web.servlet.view.BeanNameViewResolver" 
		p:order="1" />

	<bean id="tilesConfigurer" class="org.springframework.web.servlet.view.tiles2.TilesConfigurer" >
		<property name="definitions">
			<list>
				<value>/WEB-INF/tiles2def/tilesdef.xml</value>
				<value>/WEB-INF/tiles2def/tilesdef-organ.xml</value>
				<value>/WEB-INF/tiles2def/tilesdef-admin.xml</value>
				<value>/WEB-INF/tiles2def/tilesdef-user.xml</value>
			</list>
		</property>
	</bean>
	
	<bean id="multipartResolver" class="org.jabberstory.cjac.forum.controller.MultiCommonsMultipartResolver" />

	<bean id="messageSource" class="org.springframework.context.support.ResourceBundleMessageSource">
		<property name="basenames">
			<list>
				<value>messages</value>
			</list>
		</property>
	</bean>
</beans>
